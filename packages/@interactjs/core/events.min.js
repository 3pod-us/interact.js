import*as e from"../utils/arr.min.js";import*as t from"../utils/domUtils.min.js";import s from"../utils/extend.min.js";import n from"../utils/is.min.js";import r from"../utils/pointerExtend.min.js";import*as i from"../utils/pointerUtils.min.js";class o{constructor(e){this.currentTarget=void 0,this.originalEvent=void 0,this.type=void 0,this.originalEvent=e,r(this,e)}preventOriginalDefault(){this.originalEvent.preventDefault()}stopPropagation(){this.originalEvent.stopPropagation()}stopImmediatePropagation(){this.originalEvent.stopImmediatePropagation()}}function a(e){if(!n.object(e))return{capture:!!e,passive:!1};const t=s({},e);return t.capture=!!e.capture,t.passive=!!e.passive,t}export default{id:"events",install(s){const r=[],l={},p=[],c={add:u,remove:v,addDelegate(t,s,n,r,i){const o=a(i);if(!l[n]){l[n]=[];for(const e of p)u(e,n,f),u(e,n,d,!0)}const c=l[n];let v=e.find(c,e=>e.selector===t&&e.context===s);v||(v={selector:t,context:s,listeners:[]},c.push(v)),v.listeners.push([r,o])},removeDelegate(e,t,s,n,r){const i=a(r),o=l[s];let p,c=!1;if(o)for(p=o.length-1;p>=0;p--){const r=o[p];if(r.selector===e&&r.context===t){const{listeners:e}=r;for(let r=e.length-1;r>=0;r--){const[a,{capture:l,passive:u}]=e[r];if(a===n&&l===i.capture&&u===i.passive){e.splice(r,1),e.length||(o.splice(p,1),v(t,s,f),v(t,s,d,!0)),c=!0;break}}if(c)break}}},delegateListener:f,delegateUseCapture:d,delegatedEvents:l,documents:p,targets:r,supportsOptions:!1,supportsPassive:!1};function u(t,s,n,i){const o=a(i);let l=e.find(r,e=>e.eventTarget===t);l||(l={eventTarget:t,events:{}},r.push(l)),l.events[s]||(l.events[s]=[]),t.addEventListener&&!e.contains(l.events[s],n)&&(t.addEventListener(s,n,c.supportsOptions?o:o.capture),l.events[s].push(n))}function v(t,s,n,i){const o=a(i),l=e.findIndex(r,e=>e.eventTarget===t),p=r[l];if(!p||!p.events)return;if("all"===s){for(s in p.events)p.events.hasOwnProperty(s)&&v(t,s,"all");return}let u=!1;const f=p.events[s];if(f){if("all"===n){for(let e=f.length-1;e>=0;e--)v(t,s,f[e],o);return}for(let e=0;e<f.length;e++)if(f[e]===n){t.removeEventListener(s,n,c.supportsOptions?o:o.capture),f.splice(e,1),0===f.length&&(delete p.events[s],u=!0);break}}u&&!Object.keys(p.events).length&&r.splice(l,1)}function f(e,s){const r=a(s),p=new o(e),c=l[e.type],[u]=i.getEventTargets(e);let v=u;for(;n.element(v);){for(let e=0;e<c.length;e++){const s=c[e],{selector:n,context:i}=s;if(t.matchesSelector(v,n)&&t.nodeContains(i,u)&&t.nodeContains(i,v)){const{listeners:e}=s;p.currentTarget=v;for(const[t,{capture:s,passive:n}]of e)s===r.capture&&n===r.passive&&t(p)}}v=t.parentNode(v)}}function d(e){return f(e,!0)}return s.document.createElement("div").addEventListener("test",null,{get capture(){return c.supportsOptions=!0},get passive(){return c.supportsPassive=!0}}),s.events=c,c}};
//# sourceMappingURL=events.min.js.map