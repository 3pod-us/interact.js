import { JSDOM } from '@interactjs/_dev/test/domator';
import test from '@interactjs/_dev/test/test';
import interact, { scope } from './interact';
test('interact export', t => {
    scope.init(new JSDOM('').window);
    const interactable1 = interact('selector');
    t.assert(interactable1 instanceof scope.Interactable, 'interact function returns Interactable instance');
    t.equal(interact('selector'), interactable1, 'same interactable is returned with same target and context');
    t.equal(scope.interactables.list.length, 1, 'new interactables are added to list');
    interactable1.unset();
    t.equal(scope.interactables.list.length, 0, 'unset interactables are removed');
    t.strictEqual(scope.interactions.list.length, 0, 'unset interactions are removed');
    const constructsUniqueMessage = 'unique contexts make unique interactables with identical targets';
    const doc1 = new JSDOM('').window.document;
    const doc2 = new JSDOM('').window.document;
    const results = [
        ['repeat', doc1],
        ['repeat', doc2],
        [doc1, doc1],
        [doc2.body, doc2],
    ].reduce((acc, [target, context]) => {
        const interactable = interact(target, { context });
        if (acc.includes(interactable)) {
            t.fail(constructsUniqueMessage);
        }
        acc.push({ interactable, target, context });
        return acc;
    }, []);
    t.pass(constructsUniqueMessage);
    const getsUniqueMessage = 'interactions.get returns correct result with identical targets and different contexts';
    for (const { interactable, target, context } of results) {
        if (scope.interactables.get(target, { context }) !== interactable) {
            t.fail(getsUniqueMessage);
        }
    }
    t.pass(getsUniqueMessage);
    const doc3 = new JSDOM('').window.document;
    const prevDocCount = scope.documents.length;
    interact.addDocument(doc3, { events: { passive: false } });
    t.deepEqual(scope.documents[prevDocCount], { doc: doc3, options: { events: { passive: false } } }, 'interact.addDocument() adds to scope with options');
    interact.removeDocument(doc3);
    t.equal(scope.documents.length, prevDocCount, 'interact.removeDocument() removes document from scope');
    scope.interactables.list.forEach(i => i.unset());
    const plugin1 = { id: 'test-1', install() { plugin1.count++; }, count: 0 };
    const plugin2 = { id: undefined, install() { plugin2.count++; }, count: 0 };
    interact.use(plugin1);
    interact.use(plugin2);
    t.deepEqual([plugin1.count, plugin2.count], [1, 1], 'new plugin install methods are called');
    interact.use({ ...plugin1 });
    t.deepEqual([plugin1.count, plugin2.count], [1, 1], 'different plugin object with same id not installed');
    interact.use(plugin2);
    t.deepEqual([plugin1.count, plugin2.count], [1, 1], 'plugin without id not re-installed');
    t.end();
});
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiaW50ZXJhY3Quc3BlYy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbImludGVyYWN0LnNwZWMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsT0FBTyxFQUFFLEtBQUssRUFBRSxNQUFNLCtCQUErQixDQUFBO0FBQ3JELE9BQU8sSUFBSSxNQUFNLDRCQUE0QixDQUFBO0FBQzdDLE9BQU8sUUFBUSxFQUFFLEVBQUUsS0FBSyxFQUFFLE1BQU0sWUFBWSxDQUFBO0FBRTVDLElBQUksQ0FBQyxpQkFBaUIsRUFBRSxDQUFDLENBQUMsRUFBRTtJQUMxQixLQUFLLENBQUMsSUFBSSxDQUFDLElBQUksS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBRWhDLE1BQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxVQUFVLENBQUMsQ0FBQTtJQUMxQyxDQUFDLENBQUMsTUFBTSxDQUFDLGFBQWEsWUFBWSxLQUFLLENBQUMsWUFBWSxFQUNsRCxpREFBaUQsQ0FBQyxDQUFBO0lBQ3BELENBQUMsQ0FBQyxLQUFLLENBQUMsUUFBUSxDQUFDLFVBQVUsQ0FBQyxFQUFFLGFBQWEsRUFDekMsNERBQTRELENBQUMsQ0FBQTtJQUMvRCxDQUFDLENBQUMsS0FBSyxDQUFDLEtBQUssQ0FBQyxhQUFhLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQ3hDLHFDQUFxQyxDQUFDLENBQUE7SUFFeEMsYUFBYSxDQUFDLEtBQUssRUFBRSxDQUFBO0lBQ3JCLENBQUMsQ0FBQyxLQUFLLENBQUMsS0FBSyxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsTUFBTSxFQUFFLENBQUMsRUFDeEMsaUNBQWlDLENBQUMsQ0FBQTtJQUNwQyxDQUFDLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxZQUFZLENBQUMsSUFBSSxDQUFDLE1BQU0sRUFBRSxDQUFDLEVBQzdDLGdDQUFnQyxDQUFDLENBQUE7SUFFbkMsTUFBTSx1QkFBdUIsR0FDM0Isa0VBQWtFLENBQUE7SUFF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RSxDQUFDLEVBQUUsQ0FBQTtJQUUzRSxRQUFRLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3JCLFFBQVEsQ0FBQyxHQUFHLENBQUMsT0FBTyxDQUFDLENBQUE7SUFFckIsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxLQUFLLEVBQUUsT0FBTyxDQUFDLEtBQUssQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxFQUFFLHVDQUF1QyxDQUFDLENBQUE7SUFFNUYsUUFBUSxDQUFDLEdBQUcsQ0FBQyxFQUFFLEdBQUcsT0FBTyxFQUFFLENBQUMsQ0FBQTtJQUM1QixDQUFDLENBQUMsU0FBUyxDQUFDLENBQUMsT0FBTyxDQUFDLEtBQUssRUFBRSxPQUFPLENBQUMsS0FBSyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsQ0FBQyxDQUFDLEVBQUUsb0RBQW9ELENBQUMsQ0FBQTtJQUV6RyxRQUFRLENBQUMsR0FBRyxDQUFDLE9BQU8sQ0FBQyxDQUFBO0lBQ3JCLENBQUMsQ0FBQyxTQUFTLENBQUMsQ0FBQyxPQUFPLENBQUMsS0FBSyxFQUFFLE9BQU8sQ0FBQyxLQUFLLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLENBQUMsRUFBRSxvQ0FBb0MsQ0FBQyxDQUFBO0lBRXpGLENBQUMsQ0FBQyxHQUFHLEVBQUUsQ0FBQTtBQUNULENBQUMsQ0FBQyxDQUFBIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgSlNET00gfSBmcm9tICdAaW50ZXJhY3Rqcy9fZGV2L3Rlc3QvZG9tYXRvcidcbmltcG9ydCB0ZXN0IGZyb20gJ0BpbnRlcmFjdGpzL19kZXYvdGVzdC90ZXN0J1xuaW1wb3J0IGludGVyYWN0LCB7IHNjb3BlIH0gZnJvbSAnLi9pbnRlcmFjdCdcblxudGVzdCgnaW50ZXJhY3QgZXhwb3J0JywgdCA9PiB7XG4gIHNjb3BlLmluaXQobmV3IEpTRE9NKCcnKS53aW5kb3cpXG5cbiAgY29uc3QgaW50ZXJhY3RhYmxlMSA9IGludGVyYWN0KCdzZWxlY3RvcicpXG4gIHQuYXNzZXJ0KGludGVyYWN0YWJsZTEgaW5zdGFuY2VvZiBzY29wZS5JbnRlcmFjdGFibGUsXG4gICAgJ2ludGVyYWN0IGZ1bmN0aW9uIHJldHVybnMgSW50ZXJhY3RhYmxlIGluc3RhbmNlJylcbiAgdC5lcXVhbChpbnRlcmFjdCgnc2VsZWN0b3InKSwgaW50ZXJhY3RhYmxlMSxcbiAgICAnc2FtZSBpbnRlcmFjdGFibGUgaXMgcmV0dXJuZWQgd2l0aCBzYW1lIHRhcmdldCBhbmQgY29udGV4dCcpXG4gIHQuZXF1YWwoc2NvcGUuaW50ZXJhY3RhYmxlcy5saXN0Lmxlbmd0aCwgMSxcbiAgICAnbmV3IGludGVyYWN0YWJsZXMgYXJlIGFkZGVkIHRvIGxpc3QnKVxuXG4gIGludGVyYWN0YWJsZTEudW5zZXQoKVxuICB0LmVxdWFsKHNjb3BlLmludGVyYWN0YWJsZXMubGlzdC5sZW5ndGgsIDAsXG4gICAgJ3Vuc2V0IGludGVyYWN0YWJsZXMgYXJlIHJlbW92ZWQnKVxuICB0LnN0cmljdEVxdWFsKHNjb3BlLmludGVyYWN0aW9ucy5saXN0Lmxlbmd0aCwgMCxcbiAgICAndW5zZXQgaW50ZXJhY3Rpb25zIGFyZSByZW1vdmVkJylcblxuICBjb25zdCBjb25zdHJ1Y3RzVW5pcXVlTWVzc2FnZSA9XG4gICAgJ3VuaXF1ZSBjb250ZXh0cyBtYWtlIHVuaXF1ZSBpbnRlcmFjdGFibGVzIHdpdGggaWRlbnRpY2FsIHRhcmdldHMnXG5cbiAgY29uc3QgZG9jMSA9IG5ldyBKU0RPTSgnJykud2luZG93LmRvY3VtZW50XG4gIGNvbnN0IGRvYzIgPSBuZXcgSlNET00oJycpLndpbmRvdy5kb2N1bWVudFxuICBjb25zdCByZXN1bHRzID0gW1xuICAgIFsncmVwZWF0JywgZG9jMV0sXG4gICAgWydyZXBlYXQnLCBkb2MyXSxcbiAgICBbZG9jMSwgZG9jMV0sXG4gICAgW2RvYzIuYm9keSwgZG9jMl0sXG4gIF0ucmVkdWNlKChhY2MsIFt0YXJnZXQsIGNvbnRleHRdKSA9PiB7XG4gICAgY29uc3QgaW50ZXJhY3RhYmxlID0gaW50ZXJhY3QodGFyZ2V0LCB7IGNvbnRleHQgfSlcblxuICAgIGlmIChhY2MuaW5jbHVkZXMoaW50ZXJhY3RhYmxlKSkge1xuICAgICAgdC5mYWlsKGNvbnN0cnVjdHNVbmlxdWVNZXNzYWdlKVxuICAgIH1cblxuICAgIGFjYy5wdXNoKHsgaW50ZXJhY3RhYmxlLCB0YXJnZXQsIGNvbnRleHQgfSlcbiAgICByZXR1cm4gYWNjXG4gIH0sIFtdKVxuXG4gIHQucGFzcyhjb25zdHJ1Y3RzVW5pcXVlTWVzc2FnZSlcblxuICBjb25zdCBnZXRzVW5pcXVlTWVzc2FnZSA9XG4gICAgJ2ludGVyYWN0aW9ucy5nZXQgcmV0dXJucyBjb3JyZWN0IHJlc3VsdCB3aXRoIGlkZW50aWNhbCB0YXJnZXRzIGFuZCBkaWZmZXJlbnQgY29udGV4dHMnXG5cbiAgZm9yIChjb25zdCB7IGludGVyYWN0YWJsZSwgdGFyZ2V0LCBjb250ZXh0IH0gb2YgcmVzdWx0cykge1xuICAgIGlmIChzY29wZS5pbnRlcmFjdGFibGVzLmdldCh0YXJnZXQsIHsgY29udGV4dCB9KSAhPT0gaW50ZXJhY3RhYmxlKSB7XG4gICAgICB0LmZhaWwoZ2V0c1VuaXF1ZU1lc3NhZ2UpXG4gICAgfVxuICB9XG5cbiAgdC5wYXNzKGdldHNVbmlxdWVNZXNzYWdlKVxuXG4gIGNvbnN0IGRvYzMgPSBuZXcgSlNET00oJycpLndpbmRvdy5kb2N1bWVudFxuXG4gIGNvbnN0IHByZXZEb2NDb3VudCA9IHNjb3BlLmRvY3VtZW50cy5sZW5ndGhcblxuICBpbnRlcmFjdC5hZGREb2N1bWVudChkb2MzLCB7IGV2ZW50czogeyBwYXNzaXZlOiBmYWxzZSB9IH0pXG4gIHQuZGVlcEVxdWFsKFxuICAgIHNjb3BlLmRvY3VtZW50c1twcmV2RG9jQ291bnRdLFxuICAgIHsgZG9jOiBkb2MzLCBvcHRpb25zOiB7IGV2ZW50czogeyBwYXNzaXZlOiBmYWxzZSB9IH0gfSxcbiAgICAnaW50ZXJhY3QuYWRkRG9jdW1lbnQoKSBhZGRzIHRvIHNjb3BlIHdpdGggb3B0aW9ucycpXG5cbiAgaW50ZXJhY3QucmVtb3ZlRG9jdW1lbnQoZG9jMylcbiAgdC5lcXVhbChcbiAgICBzY29wZS5kb2N1bWVudHMubGVuZ3RoLFxuICAgIHByZXZEb2NDb3VudCxcbiAgICAnaW50ZXJhY3QucmVtb3ZlRG9jdW1lbnQoKSByZW1vdmVzIGRvY3VtZW50IGZyb20gc2NvcGUnKVxuXG4gIHNjb3BlLmludGVyYWN0YWJsZXMubGlzdC5mb3JFYWNoKGkgPT4gaS51bnNldCgpKVxuXG4gIGNvbnN0IHBsdWdpbjEgPSB7IGlkOiAndGVzdC0xJywgaW5zdGFsbCAoKSB7IHBsdWdpbjEuY291bnQrKyB9LCBjb3VudDogMCB9XG4gIGNvbnN0IHBsdWdpbjIgPSB7IGlkOiB1bmRlZmluZWQsIGluc3RhbGwgKCkgeyBwbHVnaW4yLmNvdW50KysgfSwgY291bnQ6IDAgfVxuXG4gIGludGVyYWN0LnVzZShwbHVnaW4xKVxuICBpbnRlcmFjdC51c2UocGx1Z2luMilcblxuICB0LmRlZXBFcXVhbChbcGx1Z2luMS5jb3VudCwgcGx1Z2luMi5jb3VudF0sIFsxLCAxXSwgJ25ldyBwbHVnaW4gaW5zdGFsbCBtZXRob2RzIGFyZSBjYWxsZWQnKVxuXG4gIGludGVyYWN0LnVzZSh7IC4uLnBsdWdpbjEgfSlcbiAgdC5kZWVwRXF1YWwoW3BsdWdpbjEuY291bnQsIHBsdWdpbjIuY291bnRdLCBbMSwgMV0sICdkaWZmZXJlbnQgcGx1Z2luIG9iamVjdCB3aXRoIHNhbWUgaWQgbm90IGluc3RhbGxlZCcpXG5cbiAgaW50ZXJhY3QudXNlKHBsdWdpbjIpXG4gIHQuZGVlcEVxdWFsKFtwbHVnaW4xLmNvdW50LCBwbHVnaW4yLmNvdW50XSwgWzEsIDFdLCAncGx1Z2luIHdpdGhvdXQgaWQgbm90IHJlLWluc3RhbGxlZCcpXG5cbiAgdC5lbmQoKVxufSlcbiJdfQ==